```html
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì¶©ë‚¨ëŒ€í•™êµ ìº í¼ìŠ¤ ì§€ë„</title>
  <style>
    body, html { margin: 0; padding: 0; width: 100%; height: 100%; font-family: 'Pretendard', -apple-system, sans-serif; }
    #map { width: 100%; height: 100%; }
    #loading { 
      position: absolute; 
      top: 50%; 
      left: 50%; 
      transform: translate(-50%, -50%);
      font-size: 18px;
      font-weight: bold;
    }
    
    /* ë§í’ì„  ì¹´ë“œ ìŠ¤íƒ€ì¼ */
    .marker-card {
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      padding: 12px;
      min-width: 200px;
      max-width: 250px;
      cursor: pointer;
      transition: all 0.2s;
      position: relative;
    }
    
    .marker-card:hover {
      box-shadow: 0 6px 16px rgba(0,0,0,0.2);
      transform: translateY(-2px);
    }
    
    .marker-card::after {
      content: '';
      position: absolute;
      bottom: -8px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 8px solid transparent;
      border-right: 8px solid transparent;
      border-top: 8px solid white;
    }
    
    .card-header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
    }
    
    .card-avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: #f0f0f0;
      font-size: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .card-title {
      font-weight: 600;
      font-size: 14px;
      color: #1a1a1a;
      margin-bottom: 4px;
    }
    
    .card-location {
      font-size: 11px;
      color: #666;
    }
    
    .card-footer {
      display: flex;
      align-items: center;
      gap: 4px;
      margin-top: 8px;
      padding-top: 8px;
      border-top: 1px solid #f0f0f0;
    }
    
    .card-likes {
      color: #ef4444;
      font-size: 12px;
      font-weight: 600;
    }
    
    .card-cta {
      font-size: 11px;
      color: #3b82f6;
      margin-left: auto;
    }
    
    .close-btn {
      position: absolute;
      top: 8px;
      right: 8px;
      width: 20px;
      height: 20px;
      border: none;
      background: #f0f0f0;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      color: #666;
      z-index: 10;
    }
    
    .close-btn:hover {
      background: #e0e0e0;
    }
  </style>
</head>
<body>
  <div id="loading">ì§€ë„ ë¡œë”© ì¤‘...</div>
  <div id="map"></div>
  
  <script>
    console.log('HTML ë¡œë“œ ì™„ë£Œ');
    
    let currentOverlay = null; // í˜„ì¬ ì—´ë¦° ì˜¤ë²„ë ˆì´
    
    // ì „ì—­ í•¨ìˆ˜ë¡œ ì˜¤ë²„ë ˆì´ ë‹«ê¸°
    window.closeCurrentOverlay = function() {
      console.log('âŒ ì˜¤ë²„ë ˆì´ ë‹«ê¸°');
      if (currentOverlay) {
        currentOverlay.setMap(null);
        currentOverlay = null;
      }
    };
    
    function hideLoading() {
      const loadingDiv = document.getElementById('loading');
      if (loadingDiv) loadingDiv.style.display = 'none';
    }
    
    // SVG ë§ˆì»¤ ìƒì„± í•¨ìˆ˜
    function createMarkerImage(color, kakao) {
      const svg = `
        <svg width="32" height="40" viewBox="0 0 32 40" xmlns="http://www.w3.org/2000/svg">
          <path d="M16 0C7.163 0 0 7.163 0 16c0 8.837 16 24 16 24s16-15.163 16-24C32 7.163 24.837 0 16 0z" fill="${color}"/>
          <circle cx="16" cy="16" r="6" fill="white"/>
        </svg>
      `;
      const blob = new Blob([svg], { type: 'image/svg+xml' });
      const url = URL.createObjectURL(blob);
      return new kakao.maps.MarkerImage(url, new kakao.maps.Size(32, 40));
    }
    
    // ê³µê°ìˆ˜ì— ë”°ë¥¸ ìƒ‰ìƒ ê²°ì •
    function getMarkerColor(likes) {
      if (likes >= 50) return '#ef4444'; // ë¹¨ê°•
      if (likes >= 20) return '#f97316'; // ì£¼í™©
      return '#eab308'; // ë…¸ë‘
    }
    
    // ì¹´ì¹´ì˜¤ë§µ SDK ë™ì  ë¡œë“œ
    function loadKakaoMapScript() {
      return new Promise((resolve, reject) => {
        if (window.kakao && window.kakao.maps) {
          console.log('ì¹´ì¹´ì˜¤ë§µ SDK ì´ë¯¸ ë¡œë“œë¨');
          resolve();
          return;
        }
        
        const script = document.createElement('script');
        script.type = 'text/javascript';
        script.src = 'https://dapi.kakao.com/v2/maps/sdk.js?appkey=46de823e6fff11047613229fe0d8049f&autoload=false';
        
        script.onload = () => {
          console.log('ì¹´ì¹´ì˜¤ë§µ ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ ì™„ë£Œ');
          kakao.maps.load(() => {
            console.log('ì¹´ì¹´ì˜¤ë§µ SDK ì´ˆê¸°í™” ì™„ë£Œ');
            resolve();
          });
        };
        
        script.onerror = () => {
          console.error('ì¹´ì¹´ì˜¤ë§µ ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ ì‹¤íŒ¨');
          reject(new Error('ì¹´ì¹´ì˜¤ë§µ SDK ë¡œë“œ ì‹¤íŒ¨'));
        };
        
        document.head.appendChild(script);
      });
    }
    
    // ì§€ë„ ì´ˆê¸°í™” í•¨ìˆ˜
    function initMap() {
      try {
        console.log('ì§€ë„ ì´ˆê¸°í™” ì‹œì‘');
        
        const container = document.getElementById('map');
        const options = {
          center: new kakao.maps.LatLng(36.3675, 127.3447),
          level: 3
        };
        const map = new kakao.maps.Map(container, options);
        
        console.log('ì§€ë„ ìƒì„± ì™„ë£Œ');
        hideLoading();
        
        // ì œë³´ ë°ì´í„°
        const reports = [
          { id: '1', title: 'í•™ìƒíšŒê´€ ì‹ë‹¹ ë¬¸ì œ', location: 'í•™ìƒíšŒê´€ 2ì¸µ ì‹ë‹¹', character: 'ğŸ¦Š', likes: 52, lat: 36.3675, lng: 127.3447 },
          { id: '2', title: 'ë„ì„œê´€ ëƒ‰ë‚œë°©', location: 'ì¤‘ì•™ë„ì„œê´€', character: 'ğŸ»', likes: 35, lat: 36.3680, lng: 127.3450 },
          { id: '3', title: 'í™”ì¥ì‹¤ ì²­ê²°', location: 'ê³µëŒ€ 5í˜¸ê´€', character: 'ğŸ°', likes: 15, lat: 36.3670, lng: 127.3440 },
        ];
        
        // ë§ˆì»¤ ìƒì„±
        reports.forEach(report => {
          const markerPosition = new kakao.maps.LatLng(report.lat, report.lng);
          const markerColor = getMarkerColor(report.likes);
          const markerImage = createMarkerImage(markerColor, kakao);
          
          const marker = new kakao.maps.Marker({
            position: markerPosition,
            image: markerImage,
            map: map
          });
          
          // ë§ˆì»¤ í´ë¦­ ì´ë²¤íŠ¸
          kakao.maps.event.addListener(marker, 'click', function() {
            console.log('ğŸ¯ ë§ˆì»¤ í´ë¦­:', report.id);
            
            // ì´ì „ ì˜¤ë²„ë ˆì´ ë‹«ê¸°
            window.closeCurrentOverlay();
            
            // ì¹´ë“œ HTML ìƒì„±
            const cardHTML = `
              <div class="marker-card" data-report-id="${report.id}">
                <button class="close-btn" onclick="event.stopPropagation(); window.closeCurrentOverlay();">Ã—</button>
                <div class="card-header">
                  <div class="card-avatar">${report.character}</div>
                  <div style="flex: 1;">
                    <div class="card-title">${report.title}</div>
                    <div class="card-location">ğŸ“ ${report.location}</div>
                  </div>
                </div>
                <div class="card-footer">
                  <span class="card-likes">â¤ï¸ ${report.likes}</span>
                  <span class="card-cta">í´ë¦­í•´ì„œ ìƒì„¸ë³´ê¸° â†’</span>
                </div>
              </div>
            `;
            
            // CustomOverlay ìƒì„±
            const overlay = new kakao.maps.CustomOverlay({
              content: cardHTML,
              position: markerPosition,
              yAnchor: 1.6, // ë§ˆì»¤ ìœ„ì— í‘œì‹œ
              zIndex: 3
            });
            
            overlay.setMap(map);
            currentOverlay = overlay;
            
            // ì¹´ë“œ í´ë¦­ ì´ë²¤íŠ¸ (ë‹¤ìŒ í”„ë ˆì„ì—ì„œ ë“±ë¡)
            setTimeout(() => {
              const cardElement = document.querySelector(`[data-report-id="${report.id}"]`);
              if (cardElement) {
                cardElement.addEventListener('click', function(e) {
                  // X ë²„íŠ¼ í´ë¦­ì´ ì•„ë‹ ë•Œë§Œ ì‹¤í–‰
                  if (!e.target.classList.contains('close-btn')) {
                    console.log('ğŸ“„ ì¹´ë“œ í´ë¦­:', report.id);
                    window.parent.postMessage({
                      type: 'markerClick',
                      reportId: report.id
                    }, '*');
                  }
                });
              }
            }, 100);
          });
        });
        
        console.log('âœ… ë§ˆì»¤ ìƒì„± ì™„ë£Œ:', reports.length);
        
        // ì§€ë„ ë“œë˜ê·¸/ì¤Œ ì‹œ ì˜¤ë²„ë ˆì´ ë‹«ê¸°
        kakao.maps.event.addListener(map, 'dragstart', window.closeCurrentOverlay);
        kakao.maps.event.addListener(map, 'zoom_changed', window.closeCurrentOverlay);
        
        // ì¤€ë¹„ ì™„ë£Œ ë©”ì‹œì§€
        window.parent.postMessage({ type: 'mapReady' }, '*');
        console.log('âœ… ëª¨ë“  ì´ˆê¸°í™” ì™„ë£Œ');
        
      } catch (error) {
        console.error('âŒ ì˜¤ë¥˜:', error);
        hideLoading();
      }
    }
    
    // SDK ë¡œë“œ í›„ ì§€ë„ ì´ˆê¸°í™”
    loadKakaoMapScript()
      .then(() => {
        initMap();
      })
      .catch((error) => {
        console.error(error);
        hideLoading();
      });
  </script>
</body>
</html>
```
