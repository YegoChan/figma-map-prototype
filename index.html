<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¶©ë‚¨ëŒ€í•™êµ ìº í¼ìŠ¤ ì§€ë„</title>
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=46de823e6fff11047613229fe0d8049f&autoload=false"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body, html {
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        #map {
            width: 100%;
            height: 100%;
        }
        .custom-marker {
            position: relative;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .custom-marker:hover {
            transform: scale(1.2);
            z-index: 1000;
        }
    </style>
</head>
<body>
    <div id="map"></div>

    <script>
        // ì œë³´ ë°ì´í„°
        const reports = [
            {
                id: '1',
                title: 'ê³µê³¼ëŒ€í•™ 1ì¸µ í™”ì¥ì‹¤ ìˆ˜ë„ ê³ ì¥',
                location: 'ê³µê³¼ëŒ€í•™ 1ì¸µ',
                likes: 67,
                commentCount: 2,
                position: { x: 35, y: 30 },
                status: 'resolved'
            },
            {
                id: '2',
                title: 'ì¤‘ì•™ë„ì„œê´€ ì—ì–´ì»¨ ê³ ì¥',
                location: 'ì¤‘ì•™ë„ì„œê´€ 3ì¸µ',
                likes: 89,
                commentCount: 1,
                position: { x: 57, y: 28 },
                status: 'in_progress'
            },
            {
                id: '3',
                title: 'í•™ìƒíšŒê´€ ì‹ë‹¹ ìœ„ìƒ ë¬¸ì œ',
                location: 'í•™ìƒíšŒê´€ 2ì¸µ ì‹ë‹¹',
                likes: 52,
                commentCount: 0,
                position: { x: 16, y: 55 },
                status: 'received'
            },
            {
                id: '4',
                title: 'ì •ì‹¬í™”ê´€ ì—˜ë¦¬ë² ì´í„° ê³ ì¥',
                location: 'ì •ì‹¬í™”ê´€',
                likes: 45,
                commentCount: 1,
                position: { x: 16, y: 30 },
                status: 'resolved'
            },
            {
                id: '5',
                title: 'ìì—°ëŒ€ ê°•ì˜ì‹¤ ë¹”í”„ë¡œì í„° ë¶ˆëŸ‰',
                location: 'ìì—°ëŒ€ 305í˜¸',
                likes: 28,
                commentCount: 0,
                position: { x: 57, y: 55 },
                status: 'inconvenient'
            },
            {
                id: '6',
                title: 'ê¸°ìˆ™ì‚¬ ìƒ¤ì›Œì‹¤ ì˜¨ìˆ˜ ì•ˆ ë‚˜ì˜´',
                location: 'ê¸°ìˆ™ì‚¬ 3ë™',
                likes: 73,
                commentCount: 1,
                position: { x: 83, y: 30 },
                status: 'in_progress'
            },
            {
                id: '7',
                title: 'ìƒí™œê³¼í•™ëŒ€ ë³µë„ ì¡°ëª… ì–´ë‘ì›€',
                location: 'ìƒí™œê³¼í•™ëŒ€ 4ì¸µ',
                likes: 36,
                commentCount: 1,
                position: { x: 35, y: 55 },
                status: 'resolved'
            },
            {
                id: '8',
                title: 'ì¤‘ì•™ê´‘ì¥ ë²¤ì¹˜ í˜ì¸íŠ¸ ë²—ê²¨ì§',
                location: 'ì¤‘ì•™ê´‘ì¥',
                likes: 19,
                commentCount: 0,
                position: { x: 42, y: 75 },
                status: 'inconvenient'
            }
        ];

        // ìƒíƒœ ë ˆì´ë¸”
        const statusLabels = {
            'inconvenient': 'ë¶ˆí¸í•´ìš”',
            'received': 'ë¬¸ì œ ì ‘ìˆ˜',
            'in_progress': 'í•´ê²° ì¤‘',
            'resolved': 'í•´ê²° ì™„ë£Œ'
        };

        const statusColors = {
            'inconvenient': '#fee2e2',
            'received': '#dbeafe',
            'in_progress': '#fef3c7',
            'resolved': '#dcfce7'
        };

        const statusTextColors = {
            'inconvenient': '#991b1b',
            'received': '#1e40af',
            'in_progress': '#854d0e',
            'resolved': '#166534'
        };

        // ê³µê°ìˆ˜ì— ë”°ë¥¸ ìƒ‰ìƒ
        function getMarkerColor(likes) {
            if (likes >= 50) return '#ef4444';
            if (likes >= 20) return '#f97316';
            return '#22c55e';
        }

        // ê³µê°ìˆ˜ì— ë”°ë¥¸ í¬ê¸°
        function getMarkerSize(likes) {
            if (likes >= 50) return 40;
            if (likes >= 20) return 34;
            return 28;
        }

        // positionì„ ìœ„ê²½ë„ë¡œ ë³€í™˜
        function positionToLatLng(position) {
            const baseLatLng = { lat: 36.3684, lng: 127.3448 };
            const lat = baseLatLng.lat + (50 - position.y) * 0.003;
            const lng = baseLatLng.lng + (position.x - 50) * 0.004;
            return { lat, lng };
        }

        // ì¹´ì¹´ì˜¤ë§µ API ë¡œë“œ í›„ ì‹¤í–‰
        kakao.maps.load(function() {
            console.log('ì¹´ì¹´ì˜¤ë§µ API ë¡œë“œ ì™„ë£Œ');
            
            const container = document.getElementById('map');
            const cnuCenter = new kakao.maps.LatLng(36.3684, 127.3448);
            
            const options = {
                center: cnuCenter,
                level: 4
            };
            
            const map = new kakao.maps.Map(container, options);
            console.log('ì§€ë„ ìƒì„± ì™„ë£Œ');
            
            // ì»¨íŠ¸ë¡¤ ì¶”ê°€
            const mapTypeControl = new kakao.maps.MapTypeControl();
            map.addControl(mapTypeControl, kakao.maps.ControlPosition.TOPRIGHT);
            
            const zoomControl = new kakao.maps.ZoomControl();
            map.addControl(zoomControl, kakao.maps.ControlPosition.RIGHT);
            
            // ë§ˆì»¤ ìƒì„±
            console.log('ë§ˆì»¤ ìƒì„± ì‹œì‘, ì œë³´ ê°œìˆ˜:', reports.length);
            
            reports.forEach((report, index) => {
                const latLng = positionToLatLng(report.position);
                const position = new kakao.maps.LatLng(latLng.lat, latLng.lng);
                
                console.log(`ë§ˆì»¤ ${index + 1}: ${report.title}`, latLng);
                
                const color = getMarkerColor(report.likes);
                const size = getMarkerSize(report.likes);
                
                // ì»¤ìŠ¤í…€ ë§ˆì»¤ HTML
                const markerContent = document.createElement('div');
                markerContent.className = 'custom-marker';
                markerContent.style.cssText = `
                    width: ${size}px;
                    height: ${size}px;
                `;
                
                markerContent.innerHTML = `
                    <svg viewBox="0 0 24 24" width="${size}" height="${size}" style="filter: drop-shadow(0 2px 4px rgba(0,0,0,0.4));">
                        <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z" fill="${color}" stroke="white" stroke-width="2"/>
                        <circle cx="12" cy="10" r="3" fill="white"/>
                    </svg>
                `;
                
                // ì»¤ìŠ¤í…€ ì˜¤ë²„ë ˆì´ ìƒì„±
                const customOverlay = new kakao.maps.CustomOverlay({
                    position: position,
                    content: markerContent,
                    yAnchor: 1
                });
                
                customOverlay.setMap(map);
                console.log(`ë§ˆì»¤ ${index + 1} ì¶”ê°€ ì™„ë£Œ`);
                
                // ì¸í¬ìœˆë„ìš° ë‚´ìš©
                const infoContent = `
                    <div style="padding: 12px; min-width: 200px; background: white; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
                        <div style="font-weight: 600; font-size: 14px; margin-bottom: 6px; color: #1a1a1a;">${report.title}</div>
                        <div style="font-size: 12px; color: #666; margin-bottom: 8px;">${report.location}</div>
                        <div style="display: flex; gap: 12px; font-size: 12px; color: #888; margin-bottom: 6px;">
                            <span>â¤ï¸ ${report.likes}</span>
                            <span>ğŸ’¬ ${report.commentCount}</span>
                        </div>
                        <div style="display: inline-block; padding: 3px 10px; border-radius: 4px; font-size: 11px; background: ${statusColors[report.status]}; color: ${statusTextColors[report.status]};">
                            ${statusLabels[report.status]}
                        </div>
                    </div>
                `;
                
                const infowindow = new kakao.maps.InfoWindow({
                    content: infoContent,
                    removable: false
                });
                
                // í´ë¦­ ì´ë²¤íŠ¸
                markerContent.addEventListener('click', function() {
                    infowindow.open(map, customOverlay);
                });
                
                // í˜¸ë²„ ì´ë²¤íŠ¸
                markerContent.addEventListener('mouseenter', function() {
                    infowindow.open(map, customOverlay);
                });
                
                markerContent.addEventListener('mouseleave', function() {
                    infowindow.close();
                });
            });
            
            console.log('ëª¨ë“  ë§ˆì»¤ ìƒì„± ì™„ë£Œ');
        });
    </script>
</body>
</html>
