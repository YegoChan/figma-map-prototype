<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¶©ë‚¨ëŒ€í•™êµ ìº í¼ìŠ¤ ì§€ë„</title>
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=46de823e6fff11047613229fe0d8049f"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body, html {
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        #map {
            width: 100%;
            height: 100%;
        }
        .custom-marker {
            position: relative;
            cursor: pointer;
        }
        .custom-marker svg {
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
            transition: transform 0.2s;
        }
        .custom-marker:hover svg {
            transform: scale(1.2);
        }
        .info-window {
            padding: 12px;
            min-width: 200px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        .info-title {
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 6px;
            color: #1a1a1a;
        }
        .info-location {
            font-size: 12px;
            color: #666;
            margin-bottom: 8px;
        }
        .info-stats {
            display: flex;
            gap: 12px;
            font-size: 12px;
            color: #888;
        }
        .info-status {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
            margin-top: 4px;
        }
        .status-resolved {
            background: #dcfce7;
            color: #166534;
        }
        .status-in_progress {
            background: #fef3c7;
            color: #854d0e;
        }
        .status-received {
            background: #dbeafe;
            color: #1e40af;
        }
        .status-inconvenient {
            background: #fee2e2;
            color: #991b1b;
        }
    </style>
</head>
<body>
    <div id="map"></div>

    <script>
        // ì œë³´ ë°ì´í„° (Figma Makeì˜ mockDataì™€ ë™ì¼)
        const reports = [
            {
                id: '1',
                title: 'ê³µê³¼ëŒ€í•™ 1ì¸µ í™”ì¥ì‹¤ ìˆ˜ë„ ê³ ì¥',
                location: 'ê³µê³¼ëŒ€í•™ 1ì¸µ',
                likes: 67,
                commentCount: 2,
                position: { x: 35, y: 30 },
                status: 'resolved'
            },
            {
                id: '2',
                title: 'ì¤‘ì•™ë„ì„œê´€ ì—ì–´ì»¨ ê³ ì¥',
                location: 'ì¤‘ì•™ë„ì„œê´€ 3ì¸µ',
                likes: 89,
                commentCount: 1,
                position: { x: 57, y: 28 },
                status: 'in_progress'
            },
            {
                id: '3',
                title: 'í•™ìƒíšŒê´€ ì‹ë‹¹ ìœ„ìƒ ë¬¸ì œ',
                location: 'í•™ìƒíšŒê´€ 2ì¸µ ì‹ë‹¹',
                likes: 52,
                commentCount: 0,
                position: { x: 16, y: 55 },
                status: 'received'
            },
            {
                id: '4',
                title: 'ì •ì‹¬í™”ê´€ ì—˜ë¦¬ë² ì´í„° ê³ ì¥',
                location: 'ì •ì‹¬í™”ê´€',
                likes: 45,
                commentCount: 1,
                position: { x: 16, y: 30 },
                status: 'resolved'
            },
            {
                id: '5',
                title: 'ìì—°ëŒ€ ê°•ì˜ì‹¤ ë¹”í”„ë¡œì í„° ë¶ˆëŸ‰',
                location: 'ìì—°ëŒ€ 305í˜¸',
                likes: 28,
                commentCount: 0,
                position: { x: 57, y: 55 },
                status: 'inconvenient'
            },
            {
                id: '6',
                title: 'ê¸°ìˆ™ì‚¬ ìƒ¤ì›Œì‹¤ ì˜¨ìˆ˜ ì•ˆ ë‚˜ì˜´',
                location: 'ê¸°ìˆ™ì‚¬ 3ë™',
                likes: 73,
                commentCount: 1,
                position: { x: 83, y: 30 },
                status: 'in_progress'
            },
            {
                id: '7',
                title: 'ìƒí™œê³¼í•™ëŒ€ ë³µë„ ì¡°ëª… ì–´ë‘ì›€',
                location: 'ìƒí™œê³¼í•™ëŒ€ 4ì¸µ',
                likes: 36,
                commentCount: 1,
                position: { x: 35, y: 55 },
                status: 'resolved'
            },
            {
                id: '8',
                title: 'ì¤‘ì•™ê´‘ì¥ ë²¤ì¹˜ í˜ì¸íŠ¸ ë²—ê²¨ì§',
                location: 'ì¤‘ì•™ê´‘ì¥',
                likes: 19,
                commentCount: 0,
                position: { x: 42, y: 75 },
                status: 'inconvenient'
            }
        ];

        // ìƒíƒœ ë ˆì´ë¸”
        const statusLabels = {
            'inconvenient': 'ë¶ˆí¸í•´ìš”',
            'received': 'ë¬¸ì œ ì ‘ìˆ˜',
            'in_progress': 'í•´ê²° ì¤‘',
            'resolved': 'í•´ê²° ì™„ë£Œ'
        };

        // ê³µê°ìˆ˜ì— ë”°ë¥¸ ìƒ‰ìƒ ê²°ì •
        function getMarkerColor(likes) {
            if (likes >= 50) return '#ef4444'; // ë¹¨ê°•
            if (likes >= 20) return '#f97316'; // ì£¼í™©
            return '#22c55e'; // ì´ˆë¡
        }

        // ê³µê°ìˆ˜ì— ë”°ë¥¸ í¬ê¸° ê²°ì •
        function getMarkerSize(likes) {
            if (likes >= 50) return 36;
            if (likes >= 20) return 32;
            return 28;
        }

        // position(x,y)ë¥¼ ì‹¤ì œ ìœ„ê²½ë„ë¡œ ë³€í™˜
        function positionToLatLng(position) {
            // ì¶©ë‚¨ëŒ€í•™êµ ìº í¼ìŠ¤ ë²”ìœ„ (ëŒ€ëµì )
            const baseLatLng = { lat: 36.3684, lng: 127.3448 };
            
            // x: 0-100 -> ê²½ë„ ë³€í™˜ (ì„œìª½ <-> ë™ìª½)
            // y: 0-100 -> ìœ„ë„ ë³€í™˜ (ë¶ìª½ <-> ë‚¨ìª½, yê°€ í´ìˆ˜ë¡ ë‚¨ìª½)
            const lat = baseLatLng.lat + (50 - position.y) * 0.003;
            const lng = baseLatLng.lng + (position.x - 50) * 0.004;
            
            return { lat, lng };
        }

        // ì»¤ìŠ¤í…€ ë§ˆì»¤ HTML ìƒì„±
        function createMarkerContent(report) {
            const color = getMarkerColor(report.likes);
            const size = getMarkerSize(report.likes);
            
            const div = document.createElement('div');
            div.className = 'custom-marker';
            div.style.width = size + 'px';
            div.style.height = size + 'px';
            
            div.innerHTML = `
                <svg viewBox="0 0 24 24" width="${size}" height="${size}" fill="${color}" stroke="white" stroke-width="1.5">
                    <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
                    <circle cx="12" cy="10" r="3" fill="white"/>
                </svg>
            `;
            
            return div;
        }

        // ì¸í¬ìœˆë„ìš° ì»¨í…ì¸  ìƒì„±
        function createInfoContent(report) {
            return `
                <div class="info-window">
                    <div class="info-title">${report.title}</div>
                    <div class="info-location">${report.location}</div>
                    <div class="info-stats">
                        <span>â¤ï¸ ${report.likes}</span>
                        <span>ğŸ’¬ ${report.commentCount}</span>
                    </div>
                    <div class="info-status status-${report.status}">
                        ${statusLabels[report.status]}
                    </div>
                </div>
            `;
        }

        // ì§€ë„ ì´ˆê¸°í™”
        window.onload = function() {
            const container = document.getElementById('map');
            
            // ì¶©ë‚¨ëŒ€í•™êµ ì¤‘ì‹¬ ì¢Œí‘œ
            const cnuCenter = new kakao.maps.LatLng(36.3684, 127.3448);
            
            const options = {
                center: cnuCenter,
                level: 4 // í™•ëŒ€ ë ˆë²¨ (ìˆ«ìê°€ ì‘ì„ìˆ˜ë¡ í™•ëŒ€)
            };
            
            const map = new kakao.maps.Map(container, options);
            
            // ì§€ë„ íƒ€ì… ì»¨íŠ¸ë¡¤ ì¶”ê°€
            const mapTypeControl = new kakao.maps.MapTypeControl();
            map.addControl(mapTypeControl, kakao.maps.ControlPosition.TOPRIGHT);
            
            // ì¤Œ ì»¨íŠ¸ë¡¤ ì¶”ê°€
            const zoomControl = new kakao.maps.ZoomControl();
            map.addControl(zoomControl, kakao.maps.ControlPosition.RIGHT);
            
            // ê° ì œë³´ì— ëŒ€í•œ ë§ˆì»¤ ìƒì„±
            reports.forEach(report => {
                const latLng = positionToLatLng(report.position);
                const position = new kakao.maps.LatLng(latLng.lat, latLng.lng);
                
                // ì»¤ìŠ¤í…€ ì˜¤ë²„ë ˆì´ ìƒì„±
                const markerContent = createMarkerContent(report);
                const customOverlay = new kakao.maps.CustomOverlay({
                    position: position,
                    content: markerContent,
                    yAnchor: 1 // ë§ˆì»¤ì˜ ì•„ë˜ìª½ì´ ìœ„ì¹˜ë¥¼ ê°€ë¦¬í‚¤ë„ë¡
                });
                
                customOverlay.setMap(map);
                
                // ì¸í¬ìœˆë„ìš° ìƒì„±
                const infowindow = new kakao.maps.InfoWindow({
                    content: createInfoContent(report),
                    removable: false
                });
                
                // ë§ˆì»¤ í´ë¦­ ì´ë²¤íŠ¸
                markerContent.addEventListener('click', function() {
                    // ëª¨ë“  ì¸í¬ìœˆë„ìš° ë‹«ê¸°
                    infowindow.close();
                    // í´ë¦­í•œ ë§ˆì»¤ì˜ ì¸í¬ìœˆë„ìš° ì—´ê¸°
                    infowindow.open(map, customOverlay);
                });
                
                // ë§ˆì»¤ í˜¸ë²„ ì´ë²¤íŠ¸
                markerContent.addEventListener('mouseenter', function() {
                    infowindow.open(map, customOverlay);
                });
                
                markerContent.addEventListener('mouseleave', function() {
                    infowindow.close();
                });
            });
        };
    </script>
</body>
</html>
